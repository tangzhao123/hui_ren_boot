<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.gson.hui_ren_boot.model.mapper.medical.ZhuYuanMapper">
<!--    修改检查完后的状态为3-->
    <update id="updateitem">
        update test set test_state = 3 where test_account = #{testAccount}
    </update>

<!--    新增结果-->
    <insert id="zyspection">
        INSERT INTO COMBINSPECTION VALUES(seq_huiren.nextval,#{inspectionName},#{inspectionContent},#{itemName},#{testId},#{comboName},#{inspectionUnit},#{inspectionPhone},current_timestamp)
    </insert>

<!--    查询项目-->
    <select id="zyitem" resultType="cn.gson.hui_ren_boot.model.pojos.medical.Comboitem">
        SELECT * FROM COMBOITEM co LEFT JOIN TESTMIDDLE te ON co.item_id = te.item_id
            LEFT JOIN TEST st ON te.test_account = st.test_account
            WHERE st.test_account = #{testAccount,jdbcType=VARCHAR}

    </select>

<!--    查询住院要检验的-->
    <select id="zycomo" resultType="cn.gson.hui_ren_boot.model.pojos.medical.Test">
        SELECT * FROM TEST
            <where>
                TEST_STATE = 1
                <if test="testName != null and testName != ''">
                    or TEST_NAME like '%${testName}%'
                </if>
                <if test="testPhone != null and testPhone != ''">
                    or  TEST_PHONE like '%${testPhone}%'
                </if>
                <if test="testGenre != null and testGenre != ''">
                    or TEST_GENRE like '%${testGenre}%'
                </if>
                <if test="testAccount != null and testAccount != ''">
                    or TEST_ACCOUNT like '%${testAccount}%'
                </if>
            </where>
    </select>
</mapper>